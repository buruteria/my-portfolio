<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetsuhiro Ishida - Portfolio</title>
    <style>
        /* --- 全体のデザインとフォント設定 --- */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Lora:wght@400;500&display=swap');

        :root {
            --bg-color: #F8F7F2;
            --text-color: #1a1a1a;
            --accent-color: #333;
            --border-color: #e5e5e5;
            --sidebar-width: 220px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
        }

        h1, h2, h3 {
            font-family: 'Lora', serif;
            font-weight: 500;
        }
        
        a {
            color: var(--text-color);
            text-decoration: none;
        }

        /* --- サイドバー --- */
        .sidebar {
            width: var(--sidebar-width);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            background-color: var(--bg-color);
            border-right: 1px solid var(--border-color);
            padding: 40px;
            display: flex;
            flex-direction: column;
            z-index: 1001;
        }
        .sidebar h1 {
            font-size: 24px;
            margin-bottom: 40px;
        }
        .sidebar nav {
            flex-grow: 1;
        }
        .sidebar nav ul {
            list-style: none;
        }
        .sidebar nav li {
            margin-bottom: 20px;
        }
        .sidebar nav a {
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
        }
        .sidebar nav a.active {
            text-decoration: underline;
        }
        .sidebar footer {
            font-size: 12px;
            color: #aaa;
        }

        /* --- メインコンテンツ --- */
        .main-content {
            margin-left: var(--sidebar-width);
            width: calc(100% - var(--sidebar-width));
            padding: 60px;
        }
        
        .page-section {
            display: none;
        }
        .page-section.active {
            display: block;
        }

        /* --- ハンバーガーメニュー --- */
        .hamburger-btn {
            display: none; /* PCでは非表示 */
            position: fixed;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: none;
            border: none;
            z-index: 1002;
            cursor: pointer;
        }
        .hamburger-btn span {
            display: block;
            width: 24px;
            height: 2px;
            background-color: var(--accent-color);
            margin: 5px auto;
            transition: all 0.3s;
        }

        .section-title {
            font-size: 36px;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 15px;
        }
        .view-all-button {
            display: inline-block;
            padding: 10px 20px;
            border: 1px solid var(--accent-color);
            margin-top: 30px;
            transition: all 0.2s;
        }
        .view-all-button:hover {
            background-color: var(--accent-color);
            color: var(--bg-color);
        }

        .main-visual {
            width: 100%;
            height: 60vh;
            background-color: #ccc;
            margin-bottom: 60px;
            background-image: url('https://images.unsplash.com/photo-1519389950473-47ba0277781c?q=80&w=2940&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
        }
        .intro-text {
            max-width: 720px;
            margin: 0 auto 60px auto;
            font-size: 16px;
            line-height: 1.8;
        }
        .intro-text p {
            margin-bottom: 1.5em;
        }
        
        .about-me {
            display: flex;
            gap: 40px;
            align-items: center;
            margin-top: 60px;
            background: #fff;
            padding: 40px;
        }
        .about-me .photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: #ccc;
            flex-shrink: 0;
            background-image: url('https://images.unsplash.com/photo-1531123414780-f74242c2b052?q=80&w=2787&auto=format&fit=crop');
            background-size: cover;
        }
        .social-links {
            display: flex;
            gap: 20px;
            margin-top: 60px;
            justify-content: center;
        }
        .social-links svg {
            width: 24px;
            height: 24px;
            fill: #777;
            transition: fill 0.2s;
        }
        .social-links a:hover svg {
            fill: var(--text-color);
        }
        
        .grid-container {
            display: grid;
            gap: 30px;
            min-height: 200px;
        }
        .grid-3-col {
            grid-template-columns: repeat(3, 1fr);
        }
        .grid-2-col {
            grid-template-columns: repeat(2, 1fr);
        }
        .card {
            background-color: #fff;
            border: 1px solid var(--border-color);
            transition: box-shadow 0.2s;
            display: flex;
            flex-direction: column;
        }
        .card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .card-image {
            width: 100%;
            padding-top: 56.25%;
            background-size: cover;
            background-position: center;
            border-bottom: 1px solid var(--border-color);
        }
        .card-content {
            padding: 20px;
            flex-grow: 1;
        }
        .card-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 10px;
        }
        .card-tags {
            font-size: 12px;
            color: #777;
        }
        .project-card {
            cursor: pointer;
        }
        
        .article-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }
        .tab-button {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background-color: #fff;
            cursor: pointer;
            border-radius: 4px;
        }
        .tab-button.active {
            background-color: var(--accent-color);
            color: #fff;
        }

        .contact-form {
            max-width: 600px;
            margin: 0 auto;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
        }
        .form-group textarea {
            min-height: 150px;
        }
        .submit-button {
            padding: 12px 24px;
            border: none;
            background-color: var(--accent-color);
            color: var(--bg-color);
            font-size: 16px;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .submit-button:hover {
            opacity: 0.8;
        }
        .contact-email {
            text-align: center;
            margin-top: 40px;
            color: #777;
        }
        .contact-email a {
            color: var(--accent-color);
            text-decoration: underline;
        }

        .project-modal-overlay {
            position: fixed; top: 0; right: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5); display: none; justify-content: flex-end; z-index: 1000;
        }
        .project-modal {
            width: 50%; max-width: 600px; height: 100%; background-color: var(--bg-color);
            padding: 40px; overflow-y: auto; transform: translateX(100%); transition: transform 0.3s ease-in-out;
        }
        .project-modal-overlay.active { display: flex; }
        .project-modal-overlay.active .project-modal { transform: translateX(0); }
        .project-modal-close { position: absolute; top: 20px; right: 20px; font-size: 30px; cursor: pointer; }

        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            .sidebar.is-open {
                transform: translateX(0);
                box-shadow: 5px 0 15px rgba(0,0,0,0.1);
            }
            .main-content {
                margin-left: 0;
                width: 100%;
            }
            .hamburger-btn {
                display: block;
            }
            .grid-3-col, .grid-2-col {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (max-width: 768px) {
            .grid-3-col, .grid-2-col { grid-template-columns: 1fr; }
            .project-modal { width: 90%; }
            .main-content { padding: 40px 20px; }
        }
    </style>
</head>
<body>

    <button id="hamburger-btn" class="hamburger-btn">
        <span></span>
        <span></span>
        <span></span>
    </button>
    
    <aside class="sidebar" id="sidebar">
        <div>
            <h1>T. Ishida</h1>
            <nav>
                <ul id="navigation">
                    <li><a href="#top" class="nav-link active">TOP</a></li>
                    <li><a href="#about" class="nav-link">ABOUT</a></li>
                    <li><a href="#articles" class="nav-link">ARTICLE</a></li>
                    <li><a href="#projects" class="nav-link">PROJECTS</a></li>
                    <li><a href="#contact" class="nav-link">CONTACT</a></li>
                </ul>
            </nav>
        </div>
        <footer>© 2025 Tetsuhiro Ishida</footer>
    </aside>

    <main class="main-content">
        <section id="top" class="page-section active">
            <div class="main-visual"></div>
            <div class="intro-text">
                <p>個人事業主の編集者・石田哲大です。起業家、デザイナー、研究者へのインタビューや、抽象度が高い概念の言語化（コンセプトエディティング）を軸に、企業やクリエイターの課題解決を支援しています。</p>
                <p>いわゆる"編集者"と聞くと、メディア記事や書籍制作が仕事というイメージがありますが、実際は法人運営から事業立ち上げ、未来に向けた経営コンセプトの言語化まで幅広いご相談があります。</p>
                <p>独立前は、ITコンサルタント、スタートアップで複数の事業開発を経験。その影響から、BTCA（ビジネス／テクノロジー／クリエイティブ／アカデミック）領域を横断して先端トピックを把握し、必要な機会があれば自分の手足を動かして実装していくスタイルを好んでいます。</p>
            </div>
            <h2 class="section-title">Article</h2>
            <div id="top-articles-grid" class="grid-container grid-3-col"></div>
            <a href="#articles" class="view-all-button nav-link">View All</a>
            <h2 class="section-title" style="margin-top: 60px;">Projects</h2>
            <div id="top-projects-grid" class="grid-container grid-2-col"></div>
            <a href="#projects" class="view-all-button nav-link">View All</a>
            <div class="about-me">
                <div class="photo"></div>
                <div>
                    <h3>About Me</h3>
                    <p>このポートフォリオサイトは、私の活動と考え方を記録するためのものです。より詳細な自己紹介はABOUTページをご覧ください。</p>
                </div>
            </div>
            <div class="social-links">
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a>
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-4.48 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path></svg></a>
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.012 3.584-.07 4.85c-.148 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.584-.012-4.85-.07c-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.85s.012-3.584.07-4.85c.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.85-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.667.072 4.947c.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072s3.667-.014 4.947-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.947s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.689-.073-4.948-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44 1.441-.645 1.441-1.44-.645-1.44-1.441-1.44z"></path></svg></a>
            </div>
        </section>

        <section id="about" class="page-section"><h2 class="section-title">About</h2><p>このページに自己紹介の詳細、経歴、スキルセットなどを記載します。</p></section>

        <section id="articles" class="page-section">
            <h2 class="section-title">Article</h2>
            <div id="article-tabs" class="article-tabs">
                <button class="tab-button active" data-category="All">All</button>
                <button class="tab-button" data-category="Biz&Tech">Biz&Tech</button>
                <button class="tab-button" data-category="Design">Design</button>
                <button class="tab-button" data-category="Creative">Creative</button>
                <button class="tab-button" data-category="Academic">Academic</button>
            </div>
            <div id="articles-grid" class="grid-container grid-3-col"></div>
        </section>
        
        <section id="projects" class="page-section">
            <h2 class="section-title">Projects</h2>
            <div id="projects-grid" class="grid-container grid-2-col"></div>
        </section>

        <section id="contact" class="page-section">
            <h2 class="section-title">Contact</h2>
            <div class="contact-form">
                <p style="margin-bottom: 20px;">ご依頼やご相談はこちらのフォームからお気軽にご連絡ください。</p>
                <form action="https://formspree.io/f/YOUR_UNIQUE_CODE" method="POST">
                    <div class="form-group">
                        <label for="name">お名前</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">メールアドレス</label>
                        <input type="email" id="email" name="_replyto" required>
                    </div>
                    <div class="form-group">
                        <label for="message">依頼内容</label>
                        <textarea id="message" name="message" required></textarea>
                    </div>
                    <button type="submit" class="submit-button">送信</button>
                </form>
                <p class="contact-email">あるいは、<a href="mailto:tetsu2626@gmail.com">こちらのメールアドレス</a>宛にご連絡ください。</p>
            </div>
        </section>
    </main>
    
    <div id="project-modal-overlay" class="project-modal-overlay">
        <div id="project-modal-content" class="project-modal"></div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        const ARTICLES_DATABASE_ID = '202fc6b604188067baedcd752b1bb428';
        const PROJECTS_DATABASE_ID = '[ProjectsページのNotionデータベースIDをここに貼り付け]';
        
        const PROP_NAMES = {
            article: {
                category: 'Content Category',
                title: 'Title',
                image: 'OGP Image',
                url: 'URL',
                role: 'Role',
                created_time: '作成日時' // Notionの「作成日時」プロパティの正式名称
            },
            project: {
                title: 'Project Name',
                image: 'Image',
                category: 'Category',
                description: 'Description'
            }
        };

        const pageElements = {
            navLinks: document.querySelectorAll('.nav-link'),
            pageSections: document.querySelectorAll('.page-section'),
            hamburgerBtn: document.getElementById('hamburger-btn'),
            sidebar: document.getElementById('sidebar'),
            articlesGrid: document.getElementById('articles-grid'),
            topArticlesGrid: document.getElementById('top-articles-grid'),
            projectsGrid: document.getElementById('projects-grid'),
            topProjectsGrid: document.getElementById('top-projects-grid'),
            articleTabs: document.getElementById('article-tabs'),
            projectModalOverlay: document.getElementById('project-modal-overlay'),
            projectModalContent: document.getElementById('project-modal-content'),
        };

        let allProjectsData = [];

        async function callNotionApi(databaseId, filter, sorts) {
            try {
                const response = await fetch('/.netlify/functions/notion', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ databaseId, filter, sorts })
                });
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(errorText || 'API request failed');
                }
                // エラーでなくても空の応答がありえるため、内容を確認
                const responseText = await response.text();
                if (!responseText) {
                    throw new Error('Server returned an empty response.');
                }
                return JSON.parse(responseText);
            } catch (error) {
                console.error('callNotionApi failed:', error);
                throw error;
            }
        }

        async function fetchAndRenderArticles(category = 'All') {
            const container = pageElements.articlesGrid;
            container.innerHTML = '<p>読み込み中...</p>';
            
            let filter = { and: [] };
            if (category !== 'All') {
                filter.and.push({
                    property: PROP_NAMES.article.category,
                    select: { equals: category }
                });
            }

            const sorts = [{
                property: PROP_NAMES.article.created_time,
                direction: 'ascending'
            }];

            try {
                const data = await callNotionApi(ARTICLES_DATABASE_ID, filter, sorts);
                container.innerHTML = '';
                if (data.results.length === 0) {
                    container.innerHTML = '<p>表示できる記事がありません。</p>';
                    return;
                }
                data.results.forEach(article => {
                    const props = article.properties;
                    const title = props[PROP_NAMES.article.title]?.title[0]?.plain_text || 'No Title';
                    const imageUrl = props[PROP_NAMES.article.image]?.files[0]?.file?.url || props[PROP_NAMES.article.image]?.files[0]?.external?.url || '';
                    const pageUrl = props[PROP_NAMES.article.url]?.url || '#';
                    const role = props[PROP_NAMES.article.role]?.multi_select.map(t => t.name).join(', ') || '';

                    const cardHtml = `
                        <a href="${pageUrl}" target="_blank" rel="noopener noreferrer" class="card">
                            <div class="card-image" style="background-image: url('${imageUrl}')"></div>
                            <div class="card-content">
                                <p class="card-title">${title}</p>
                                <p class="card-tags">${role}</p>
                            </div>
                        </a>
                    `;
                    container.insertAdjacentHTML('beforeend', cardHtml);
                });
            } catch (error) {
                console.error('Articlesの取得に失敗:', error);
                container.innerHTML = `<p>記事データの取得に失敗しました。詳細：${error.message}</p>`;
            }
        }
        
        async function fetchAndRenderProjects() {
            const projectsContainer = pageElements.projectsGrid;
            const topProjectsContainer = pageElements.topProjectsGrid;
            projectsContainer.innerHTML = '<p>読み込み中...</p>';
            topProjectsContainer.innerHTML = '<p>読み込み中...</p>';
            
            try {
                const data = await callNotionApi(PROJECTS_DATABASE_ID, {});
                allProjectsData = data.results;

                projectsContainer.innerHTML = '';
                topProjectsContainer.innerHTML = '';

                if (allProjectsData.length === 0) {
                     projectsContainer.innerHTML = topProjectsContainer.innerHTML = '<p>表示できるプロジェクトがありません。</p>';
                     return;
                }
                
                allProjectsData.forEach(project => renderProjectCard(projectsContainer, project));
                allProjectsData.slice(0, 2).forEach(project => renderProjectCard(topProjectsContainer, project));

            } catch (error) {
                console.error('Projectsの取得に失敗:', error);
                projectsContainer.innerHTML = topProjectsContainer.innerHTML = `<p>プロジェクトデータの取得に失敗しました。データベースID等を確認してください。</p>`;
            }
        }
        
        function renderProjectCard(container, project) {
             const props = project.properties;
             const title = props[PROP_NAMES.project.title]?.title[0]?.plain_text || 'No Title';
             const imageUrl = props[PROP_NAMES.project.image]?.files[0]?.file?.url || props[PROP_NAMES.project.image]?.files[0]?.external?.url || '';
             const category = props[PROP_NAMES.project.category]?.select?.name || '';
             
             const cardHtml = `
                <div class="card project-card" data-project-id="${project.id}">
                    <div class="card-image" style="background-image: url('${imageUrl}')"></div>
                    <div class="card-content">
                        <p class="card-title">${title}</p>
                        <p class="card-tags">${category}</p>
                    </div>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', cardHtml);
        }
        
        function openProjectModal(projectId) {
            const project = allProjectsData.find(p => p.id === projectId);
            if (!project) return;
            
            const props = project.properties;
            const title = props[PROP_NAMES.project.title]?.title[0]?.plain_text || 'No Title';
            const imageUrl = props[PROP_NAMES.project.image]?.files[0]?.file?.url || props[PROP_NAMES.project.image]?.files[0]?.external?.url || '';
            const description = props[PROP_NAMES.project.description]?.rich_text.map(t => t.plain_text).join('') || '詳細情報がありません。';

            pageElements.projectModalContent.innerHTML = `
                <span class="project-modal-close">&times;</span>
                <h2 style="font-size: 28px; margin-bottom: 20px;">${title}</h2>
                <div style="width: 100%; height: 300px; background-image: url('${imageUrl}'); background-size: cover; background-position: center; margin-bottom: 20px;"></div>
                <p>${description.replace(/\n/g, '<br>')}</p>
            `;
            pageElements.projectModalOverlay.classList.add('active');
            pageElements.projectModalContent.querySelector('.project-modal-close').addEventListener('click', closeProjectModal);
        }
        
        function closeProjectModal() {
            pageElements.projectModalOverlay.classList.remove('active');
        }

        function navigateTo(pageId) {
            pageElements.pageSections.forEach(section => section.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            pageElements.navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${pageId}`) {
                    link.classList.add('active');
                }
            });
            window.scrollTo(0, 0);
            pageElements.sidebar.classList.remove('is-open');
        }
        
        function initialLoad() {
            fetchAndRenderArticles('All');
            fetchAndRenderProjects();

            const observer = new MutationObserver((mutations, obs) => {
                const articleNodes = pageElements.articlesGrid.querySelectorAll('.card');
                if (articleNodes.length > 0) {
                    pageElements.topArticlesGrid.innerHTML = '';
                    for (let i = 0; i < 3 && i < articleNodes.length; i++) {
                        pageElements.topArticlesGrid.appendChild(articleNodes[i].cloneNode(true));
                    }
                    obs.disconnect();
                }
            });
            observer.observe(pageElements.articlesGrid, { childList: true });
        }
        
        pageElements.navLinks.forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); navigateTo(link.getAttribute('href').substring(1)); }); });
        pageElements.articleTabs.addEventListener('click', (e) => { if (e.target.classList.contains('tab-button')) { document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active')); e.target.classList.add('active'); fetchAndRenderArticles(e.target.dataset.category); } });
        document.addEventListener('click', (e) => { const card = e.target.closest('.project-card'); if (card) { openProjectModal(card.dataset.projectId); } });
        pageElements.projectModalOverlay.addEventListener('click', (e) => { if (e.target === pageElements.projectModalOverlay) { closeProjectModal(); } });

        initialLoad();
    });
    </script>
</body>
</html>
