<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetsuhiro Ishida - Portfolio</title>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tetsuhiro-ishida.netlify.app/">
    <meta property="og:title" content="Tetsuhiro Ishida ホームページ">
    <meta property="og:description" content="編集者・石田哲大のホームページ。インタビュー取材や編集、事業・サービスのコンセプト設計まで、言葉を軸にした課題解決を支援します。">
    <meta property="og:image" content="https://tetsuhiro-ishida.netlify.app/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Tetsuhiro Ishida Homepage">
    <meta property="og:locale" content="ja_JP">
    
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://tetsuhiro-ishida.netlify.app/">
    <meta property="twitter:title" content="Tetsuhiro Ishida">
    <meta property="twitter:description" content="編集者・石田哲大のホームページ。インタビュー取材や編集、事業・サービスのコンセプト設計まで、言葉を軸にした課題解決を支援します。">
    <meta property="twitter:image" content="https://tetsuhiro-ishida.netlify.app/og-image.jpg">
    
    <!-- General Meta Tags -->
    <meta name="description" content="編集者・石田哲大のホームページ。インタビュー取材や編集、事業・サービスのコンセプト設計まで、言葉を軸にした課題解決を支援します。">
    <meta name="keywords" content="編集者,石田哲大,Tetsuhiro Ishida,コンセプトエディティング,インタビュー,編集,執筆,メディア,事業開発,ポートフォリオ">
    <meta name="author" content="Tetsuhiro Ishida">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <style>
        /* --- 全体のデザインとフォント設定 --- */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap');

        :root {
            --bg-color: #F8F7F2;
            --text-color: #1a1a1a;
            --accent-color: #333;
            --border-color: #e5e5e5;
            --sidebar-width: 220px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', 'Yu Gothic Medium', 'Meiryo', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
        }

        h1, h2, h3 {
            font-family: 'Playfair Display', Georgia, 'Hiragino Mincho ProN', 'Yu Mincho Medium', serif;
            font-weight: 500;
        }
        
        a {
            color: var(--text-color);
            text-decoration: none;
        }

        /* --- サイドバー --- */
        .sidebar {
            width: var(--sidebar-width);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            background-color: var(--bg-color);
            border-right: 1px solid var(--border-color);
            padding: 40px;
            display: flex;
            flex-direction: column;
            z-index: 1001;
        }
        .sidebar .logo {
            font-family: 'Playfair Display', Georgia, 'Hiragino Mincho ProN', 'Yu Mincho Medium', serif;
            font-size: 22px;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 60px;
            color: var(--accent-color);
        }
        .sidebar nav {
            flex-grow: 1;
        }
        .sidebar nav ul {
            list-style: none;
        }
        .sidebar nav li {
            margin-bottom: 20px;
        }
        .sidebar nav a {
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
        }
        .sidebar nav a.active {
            text-decoration: underline;
        }
        .sidebar footer {
            font-size: 12px;
            color: #aaa;
        }

        /* --- メインコンテンツ --- */
        .main-content {
            margin-left: var(--sidebar-width);
            width: calc(100% - var(--sidebar-width));
            padding: 60px;
        }
        
        .page-section {
            display: none;
        }
        .page-section.active {
            display: block;
        }

        /* --- ハンバーガーメニュー --- */
        .hamburger-btn {
            display: none; /* PCでは非表示 */
            position: fixed;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: none;
            border: none;
            z-index: 1002;
            cursor: pointer;
        }
        .hamburger-btn span {
            display: block;
            width: 24px;
            height: 2px;
            background-color: var(--accent-color);
            margin: 5px auto;
            transition: all 0.3s;
        }

        .section-title {
            font-size: 36px;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 15px;
        }
        .view-all-button {
            display: inline-block;
            padding: 10px 20px;
            border: 1px solid var(--accent-color);
            margin-top: 30px;
            transition: all 0.2s;
            border-radius: 999px;
        }
        .view-all-button:hover {
            background-color: var(--accent-color);
            color: var(--bg-color);
        }
        .view-more-button {
            display: inline-block;
            padding: 8px 16px;
            border: 1px solid var(--accent-color);
            margin-top: 20px;
            transition: all 0.2s;
            border-radius: 999px;
            font-size: 14px;
            font-weight: 500;
        }
        .view-more-button:hover {
            background-color: var(--accent-color);
            color: var(--bg-color);
        }

        .main-visual {
            width: 100%;
            height: 50vh;
            min-height: 280px;
            max-height: 400px;
            background-color: #f8f7f1;
            margin-bottom: 50px;
            border-radius: 16px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .signature-image {
            max-width: 65%;
            max-height: 80%;
            object-fit: contain;
            opacity: 1;
        }
        .intro-text {
            max-width: 720px;
            margin: 0 auto 60px auto;
            font-size: 16px;
            line-height: 1.8;
        }
        .intro-text p {
            margin-bottom: 1.5em;
        }
        
        .about-me {
            display: flex;
            gap: 40px;
            align-items: center;
            margin-top: 60px;
            background: #fff;
            padding: 40px;
            border-radius: 16px;
        }
        .about-me .photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: #ccc;
            flex-shrink: 0;
            background-image: url('https://images.unsplash.com/photo-1531123414780-f74242c2b052?q=80&w=2787&auto=format&fit=crop');
            background-size: cover;
        }
        .social-links {
            display: flex;
            gap: 20px;
            margin-top: 60px;
            justify-content: center;
        }
        .social-links svg {
            width: 24px;
            height: 24px;
            fill: #777;
            transition: fill 0.2s;
        }
        .social-links a:hover svg {
            fill: var(--text-color);
        }
        
        .grid-container {
            display: grid;
            gap: 30px;
            min-height: 200px;
        }
        .grid-3-col {
            grid-template-columns: repeat(3, 1fr);
        }
        .grid-2-col {
            grid-template-columns: repeat(2, 1fr);
        }
        .grid-4-col {
            grid-template-columns: repeat(4, 1fr);
        }
        .card {
            background-color: #fff;
            border: 1px solid var(--border-color);
            border-radius: 16px;
            transition: box-shadow 0.3s, transform 0.3s;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
        }
        .card-image {
            width: 100%;
            height: 220px;
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            position: relative;
            overflow: hidden;
        }
        .card-content {
            padding: 20px 24px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .card-media {
            font-size: 12px;
            font-weight: 500;
            color: #888;
            margin-bottom: 8px;
        }
        .card-title {
            font-size: 20px;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 12px;
            flex-grow: 1;
        }
        .card-tags {
            font-size: 12px;
            color: #777;
        }
        .project-card {
            cursor: pointer;
        }
        .project-card-image {
            width: 100%;
            height: 150px;
            background-color: #f8f8f8;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 18px;
            font-weight: 500;
            text-align: center;
            padding: 20px;
            line-height: 1.3;
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            overflow: hidden;
            position: relative;
        }
        .project-card-image.loading {
            background-color: #f0f0f0;
            color: #888;
            font-size: 14px;
        }
        .project-card-content {
            padding: 16px 20px;
        }
        .project-card-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 8px;
        }
        .project-card-role {
            font-size: 13px;
            color: #777;
        }
        
        .article-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
        }
        .tab-button {
            padding: 8px 20px;
            border: 1px solid var(--border-color);
            background-color: transparent;
            color: var(--accent-color);
            cursor: pointer;
            border-radius: 999px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .tab-button:hover {
            border-color: var(--accent-color);
        }
        .tab-button.active {
            background-color: var(--accent-color);
            color: var(--bg-color);
            border-color: var(--accent-color);
        }

        .contact-form {
            max-width: 600px;
            margin: 0 auto;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
        }
        .form-group textarea {
            min-height: 150px;
        }
        .submit-button {
            padding: 12px 24px;
            border: none;
            background-color: var(--accent-color);
            color: var(--bg-color);
            font-size: 16px;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .submit-button:hover {
            opacity: 0.8;
        }
        .contact-email {
            text-align: center;
            margin-top: 40px;
            color: #777;
        }
        .contact-email a {
            color: var(--accent-color);
            text-decoration: underline;
        }

        /* --- Project Modal Styles (Restored) --- */
        .project-modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.6);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000;
            opacity: 0; visibility: hidden; transition: all 0.3s;
        }
        .project-modal-overlay.active {
            opacity: 1; visibility: visible;
        }
        .project-modal {
            width: 85%; max-width: 800px; max-height: 90vh;
            background-color: var(--bg-color);
            border-radius: 16px;
            display: flex; flex-direction: column;
            transform: scale(0.95); transition: transform 0.3s;
            margin: 0 auto;
        }
        .project-modal-overlay.active .project-modal {
            transform: scale(1);
        }
        .project-modal-header {
            padding: 25px 50px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        .project-modal-header h2 {
            font-size: 28px;
            margin: 0;
            font-family: 'Playfair Display', Georgia, 'Hiragino Mincho ProN', 'Yu Mincho Medium', serif;
            font-weight: 600;
        }
        .project-modal-close {
            font-size: 30px;
            cursor: pointer;
            color: #aaa;
            line-height: 1;
        }
        .project-modal-close:hover {
            color: var(--text-color);
        }
        .project-modal-body {
            padding: 40px 60px;
            overflow-y: auto;
            max-width: 100%;
            margin: 0 auto;
        }
        
        /* --- Modal Content Styles --- */
        .detail-item {
            margin-bottom: 30px;
        }
        .detail-item strong {
            display: block;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--accent-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 8px;
        }
        .detail-item p {
            line-height: 1.7;
            margin-bottom: 1em;
        }
        .detail-item div {
            line-height: 1.8;
        }
        
        /* --- OGP Card Styles (Restored) --- */
        #ogp-card-container {
            margin-bottom: 35px;
        }
        .ogp-card {
            display: flex;
            flex-direction: column;
            border: 1px solid #e1e4e8;
            border-radius: 12px;
            overflow: hidden;
            text-decoration: none;
            color: inherit;
            background-color: #fff;
            transition: box-shadow 0.2s;
            max-width: 100%;
        }
        .ogp-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        .ogp-card-image {
            width: 100%;
            min-height: 200px;
            max-height: 400px;
            background-color: #f6f8fa;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        .ogp-card-image img {
            width: 100%;
            height: auto;
            max-height: 400px;
            object-fit: cover;
            object-position: center center;
            transition: transform 0.3s ease;
        }
        .ogp-card-info {
            padding: 20px 24px;
        }
        .ogp-card-description {
            font-size: 15px;
            color: #586069;
            line-height: 1.6;
            margin-bottom: 16px;
            font-family: 'Inter', sans-serif;
        }
        .ogp-card-url {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #888;
        }
        .ogp-card-url img {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }
        
        /* --- Custom List Styles (Restored) --- */
        .custom-list {
            list-style: none;
            padding-left: 0;
        }
        .custom-list li {
            padding-left: 2em;
            position: relative;
            margin-bottom: 1em;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            color: #444;
        }
        .custom-list li::before {
            content: '•';
            position: absolute;
            left: 0.5em;
            top: -0.1em;
            font-size: 1.3em;
            font-weight: bold;
            color: var(--accent-color);
        }

        /* --- ▼ カード内タグ用のスタイルを追加 ▼ --- */
.card-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: auto; /* タグをカード下部に配置 */
    padding-top: 12px;
}
.card-tag-pill {
    display: inline-block;
    padding: 4px 10px;
    font-size: 11px;
    font-weight: 500;
    background-color: #f0f0f0;
    color: #555;
    border-radius: 999px;
}

        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            .sidebar.is-open {
                transform: translateX(0);
                box-shadow: 5px 0 15px rgba(0,0,0,0.1);
            }
            .main-content {
                margin-left: 0;
                width: 100%;
            }
            .hamburger-btn {
                display: block;
            }
            .grid-3-col, .grid-2-col, .grid-4-col {
                grid-template-columns: repeat(2, 1fr);
            }
            
            /* About詳細のレスポンシブ調整 */
            .profile-content {
                flex-direction: column;
                gap: 40px;
                text-align: center;
            }
            .profile-photo {
                flex: none;
                align-self: center;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            .about-photo-circle {
                width: 150px;
                height: 150px;
            }
            .profile-text {
                text-align: center;
            }
        }
        @media (max-width: 768px) {
            .grid-3-col, .grid-2-col, .grid-4-col { 
                grid-template-columns: 1fr; 
            }
            .project-modal { 
                width: 95%; 
                max-width: none;
            }
            .project-modal-body {
                padding: 30px 25px;
            }
            .project-modal-header {
                padding: 20px 25px;
            }
            .main-content { 
                padding: 30px 20px; 
            }
            
            /* 小さい画面での調整 */
            .about-me {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            .about-me .photo {
                width: 120px;
                height: 120px;
                margin: 0 auto;
            }
            .about-photo-circle {
                width: 120px;
                height: 120px;
            }
            
            /* About セクションの間隔調整 */
            .about-intro-section,
            .about-service-section,
            .about-profile-section,
            .about-sns-section,
            .about-column-section,
            .about-tools-section {
                margin-bottom: 60px;
                padding: 0 15px;
            }
            
                         /* OGPカード画像の調整 */
             .ogp-card-image {
                 max-height: 250px;
             }
             .ogp-card-image img {
                 width: 100%;
                 height: auto;
                 max-height: 250px;
                 object-fit: cover;
                 object-position: center center;
             }
            
            /* プロジェクトカード画像の高さ調整 */
            .project-card-image {
                height: 120px;
                padding: 15px;
                font-size: 16px;
            }
            
                         /* カードタイトルのフォントサイズ調整 */
             .card-title {
                 font-size: 18px;
             }
             .project-card-title {
                 font-size: 15px;
             }
             
             /* タブレットサイズでの画像調整 */
             .card-image {
                 height: 200px;
             }
        }
        
        @media (max-width: 480px) {
            /* 非常に小さい画面での追加調整 */
            .main-content { 
                padding: 20px 15px; 
            }
            .section-title {
                font-size: 28px;
            }
            .project-card-image {
                height: 100px;
                padding: 10px;
                font-size: 14px;
            }
            .card-title {
                font-size: 16px;
            }
            .project-card-title {
                font-size: 14px;
            }
            
            /* OGPカード画像をさらに最適化 */
            .ogp-card-image {
                max-height: 200px;
            }
            .ogp-card-image img {
                max-height: 200px;
            }
            
            /* メインビジュアルの調整 */
            .main-visual {
                height: 45vh;
                min-height: 220px;
                max-height: 320px;
                margin-bottom: 40px;
            }
            
            .signature-image {
                max-width: 80%;
                max-height: 85%;
            }
            
                         /* 記事カード画像の調整 */
             .card-image {
                 height: 180px;
             }
        }

        /* --- About Page Styles --- */
        /* 共通スタイル */
        .about-intro-section,
        .about-service-section,
        .about-profile-section,
        .about-sns-section,
        .about-column-section,
        .about-tools-section {
            max-width: 900px;
            margin: 0 auto 80px auto;
            padding: 0 20px;
        }
        
        .about-intro-section h3,
        .about-service-section h3,
        .about-profile-section h3,
        .about-sns-section h3,
        .about-column-section h3,
        .about-tools-section h3 {
            font-size: 32px;
            font-family: 'Playfair Display', Georgia, 'Hiragino Mincho ProN', 'Yu Mincho Medium', serif;
            font-weight: 500;
            margin-bottom: 30px;
            text-align: center;
            color: var(--accent-color);
        }
        
        /* About Me・Service・Column・Tools セクション（左詰め・幅制限） */
        .about-intro-section,
        .about-service-section,
        .about-column-section,
        .about-tools-section {
            text-align: left;
            max-width: 720px;
            margin: 0 auto 40px auto;
        }
        
        .about-intro-section p,
        .about-service-section p,
        .about-column-section p,
        .about-tools-section p {
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 1.5em;
            color: var(--text-color);
        }
        
        /* Service リスト */
        .service-list {
            list-style: none;
            padding-left: 0;
            text-align: left;
            max-width: 720px;
            margin: 30px auto;
        }
        
        .service-list li {
            margin-bottom: 1.2em;
            padding-left: 1.5em;
            position: relative;
            line-height: 1.7;
        }
        
        .service-list li::before {
            content: '•';
            position: absolute;
            left: 0;
            top: 0;
            font-size: 1.2em;
            font-weight: bold;
            color: var(--accent-color);
        }
        
        /* Profile セクション（左1/4・右3/4レイアウト） */
        .about-profile-section {
            max-width: 720px;
            margin: 0 auto 40px auto;
        }
        .profile-content {
            display: flex;
            gap: 60px;
            align-items: flex-start;
            margin-top: 40px;
        }
        
        .profile-photo {
            flex: 0 0 25%; /* 1/4の幅で固定 */
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }
        
        .about-photo-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background-color: #ccc;
            background-image: url('https://images.unsplash.com/photo-1531123414780-f74242c2b052?q=80&w=2787&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            flex-shrink: 0;
        }
        
        .profile-text {
            flex: 1; /* 3/4の幅 */
            text-align: left;
        }
        
        .profile-text p {
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 1.5em;
            color: var(--text-color);
        }
        
        .profile-social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .profile-social-links a {
            display: block;
            width: 24px;
            height: 24px;
            color: var(--text-color);
            transition: color 0.2s;
        }
        
        .profile-social-links a:hover {
            color: var(--accent-color);
        }
        
        .profile-social-links svg {
            width: 100%;
            height: 100%;
        }
        
        /* Tools セクション専用スタイル */
        .tools-list {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin: 20px 0;
        }
        
        .tool-item {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 14px;
            color: var(--text-color);
            transition: all 0.2s ease;
        }
        
        .tool-item:hover {
            background-color: var(--accent-color);
            color: white;
            transform: translateY(-1px);
        }
        
        .ai-note {
            font-size: 14px;
            color: #888;
            margin-top: 30px;
            font-style: italic;
        }

    </style>
</head>
<body>

    <button id="hamburger-btn" class="hamburger-btn">
        <span></span>
        <span></span>
        <span></span>
    </button>
    
    <aside class="sidebar" id="sidebar">
        <div>
            <h1 class="logo">Tetsuhiro<br>Ishida</h1>
            <nav>
                <ul id="navigation">
                    <li><a href="#top" class="nav-link active">TOP</a></li>
                    <li><a href="#about" class="nav-link">ABOUT</a></li>
                    <li><a href="#articles" class="nav-link">ARTICLES</a></li>
                    <li><a href="#projects" class="nav-link">PROJECTS</a></li>
                    <li><a href="#contact" class="nav-link">CONTACT</a></li>
                </ul>
            </nav>
        </div>
        <footer>© 2025 Tetsuhiro Ishida</footer>
    </aside>

    <main class="main-content">
        <section id="top" class="page-section active">
            <div class="main-visual">
                <img src="tetsuhiro-signature.png" alt="Tetsuhiro Ishida Signature" class="signature-image">
            </div>
            <div class="intro-text">
                <p>編集者・石田哲大のホームページです。事業やサービスのコンセプト設計から、インタビュー取材、編集、メディア戦略まで、言葉を軸にした課題解決を支援します。</p>
            </div>
            <h2 class="section-title">Articles</h2>
            <div id="top-articles-grid" class="grid-container grid-3-col"></div>
            <a href="#articles" class="view-all-button nav-link">View All</a>
            <h2 class="section-title" style="margin-top: 60px;">Projects</h2>
            <div id="top-projects-grid" class="grid-container grid-4-col"></div>
            <a href="#projects" class="view-all-button nav-link">View All</a>
            <div class="about-me">
                <div class="photo" style="background-image: url('profile.jpg'); background-size: cover; background-position: center;"></div>
                <div>
                    <p><strong>石田哲大</strong><br><br>
                    編集者（個人事業主）。起業家、デザイナー、研究者へのインタビュー取材や編集をメインに活動しています。<br>
                    国際基督教大学（ICU）卒。92年北海道生まれ。</p>
                    <a href="#about" class="view-more-button nav-link">View More</a>
                </div>
            </div>
            <div class="social-links">
                 <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a>
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-4.48 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path></svg></a>
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.012 3.584-.07 4.85c-.148 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.584-.012-4.85-.07c-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.85s.012-3.584.07-4.85c.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.85-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.667.072 4.947c.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072s3.667-.014 4.947-.072c4.354-.2 6.782-2.618 6.78-6.98.059-1.28.073-1.689.073-4.947s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.689-.073-4.948-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44 1.441-.645 1.441-1.44-.645-1.44-1.441-1.44z"></path></svg></a>
            </div>
        </section>

        <section id="about" class="page-section">
            <h2 class="section-title">About</h2>
            
            <!-- About Me セクション（ワイド幅・左詰め） -->
            <div class="about-intro-section">
                <p></p>
                <p>はじめまして！個人事業主の編集者・石田哲大です。</p>
                <p>起業家、デザイナー、研究者へのインタビューや、ちょっと複雑でわかりづらい概念的なものの編集（コンセプトエディティング）を軸に、企業やクリエイターの課題解決を支援しています。</p>
                <p>いわゆる"編集者"のお仕事といえば、メディア記事や書籍制作をイメージすると思いますが、法人運営から新規事業の伴走、長期的な経営コンセプトの言語化まで幅広いご相談があります。</p>
            </div>
            
            <!-- Service セクション（ワイド幅・中央揃え） -->
            <div class="about-service-section">
                <h3>Service</h3>
                <p>ビジネス、テクノロジー、クリエイティブ、アカデミック（BTCA）領域を対応する横断力と、実装までイメージして手足を動かすスタイルが持ち味です。「こんなことできません？」というふわっとしたご相談も大歓迎です。</p>
                <ul class="service-list">
                    <li><strong>インタビュー</strong>: 起業家、デザイナー、研究者など、専門性が高い領域に取り組む方々の思想や哲学を引き出す文章・冊子制作が得意です。</li>
                    <li><strong>メディア運営・編集</strong>: メディアの立ち上げ、コンテンツ企画、編集体制の構築など。</li>
                    <li><strong>コンセプト設計</strong>: 事業、サービス、組織のコンセプト設計や、ビジョン・ミッション・バリューの言語化支援も行っています。</li>
                    <li><strong>事業開発支援</strong>: 新規事業の壁打ち、PoCなどの伴走支援。起業家・経営者の方々へのメンタリングもご相談を受け付けています。</li>

                </ul>
            </div>
            
            <!-- Profile セクション（左側1/4アイコン・右側3/4プロフィール文） -->
            <div class="about-profile-section">
                <h3>Profile</h3>
                <div class="profile-content">
                    <div class="profile-photo">
                        <div class="about-photo-circle" style="background-image: url('profile.jpg'); background-size: cover; background-position: center;"></div>
                        <div class="profile-social-links">
                            <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>
                            <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a>
                            <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="3" width="18" height="18" rx="6" ry="6" fill="currentColor"/><text x="12" y="16" text-anchor="middle" font-family="serif" font-size="12" font-weight="bold" fill="white">n</text></svg></a>
                        </div>
                    </div>
                    <div class="profile-text">
                        <p>石田哲大（いしだ・てつひろ）<br><br>
                        編集者（個人事業主）。国際基督教大学（ICU）卒。92年北海道生まれ。</p>
                        <p>新卒でITコンサルタントを経験後、創業期のロボット系スタートアップに参画。複数の新規事業開発を担当。農業IoTメーカー事業では、プロダクトマネージャーとして製品戦略から市場投入、生産管理まで担当。その後、株式会社アンドパッドのPMを経て独立。</p>
                        
                        <p>同時にダブルワークで編集プロダクションに所属、スタートアップやVCの取材を数多く経験。独立後はデザイン、先端テクノロジー、人文・社会科学系まで領域を広げる。編著「DE-SILO RESEARCH REPORT──人文・社会科学の未来を拓く30論点：研究エコシステムの『脱サイロ化』に向けて」（2024）。
                        
                        </p>
                    </div>
                </div>
            </div>


            <!-- Column セクション（ワイド幅・中央揃え） -->
            <div class="about-column-section">
                <h3>Column</h3>
                <p>執筆したエッセイ記事などをまとめる予定です。（更新待ち）</p>
                
            </div>

            <!-- Tools セクション -->
            <div class="about-tools-section">
                <h3>Tools</h3>
                <div class="tools-list">
                    <span class="tool-item">Cursor</span>
                    <span class="tool-item">Claude Code</span>
                    <span class="tool-item">Gemini</span>
                    <span class="tool-item">Slack</span>
                    <span class="tool-item">Discord</span>
                    <span class="tool-item">Microsoft Teams</span>
                    <span class="tool-item">Google Workspace</span>
                    <span class="tool-item">HubSpot</span>
                    <span class="tool-item">Notion</span>
                    
                </div>
                <p class="ai-note">※本ホームページはAIを用いた個人開発で制作しています。</p>
            </div>
        </section>

        <section id="articles" class="page-section">
            <h2 class="section-title">Articles</h2>
            <div id="article-tabs" class="article-tabs">
                <button class="tab-button" data-category="Design">Design</button>
                <button class="tab-button" data-category="Academic">Academic</button>
                <button class="tab-button" data-category="Biz/Tech">Biz/Tech</button>
                <button class="tab-button" data-category="Creative">Creative</button>
            </div>
            <div id="articles-grid" class="grid-container grid-3-col"></div>
        </section>
        
        <section id="projects" class="page-section">
            <h2 class="section-title">Projects</h2>
            <div id="projects-grid" class="grid-container grid-4-col"></div>
        </section>

        <section id="contact" class="page-section">
            <h2 class="section-title">Contact</h2>
            <div class="contact-form">
                <p style="margin-bottom: 20px;">ご依頼やご相談はこちらのフォームから気軽にご連絡ください。</p>
                <form action="https://formspree.io/f/YOUR_UNIQUE_CODE" method="POST">
                    <div class="form-group">
                        <label for="name">お名前</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">メールアドレス</label>
                        <input type="email" id="email" name="_replyto" required>
                    </div>
                    <div class="form-group">
                        <label for="message">ご相談内容</label>
                        <textarea id="message" name="message" required></textarea>
                    </div>
                    <button type="submit" class="submit-button">送信</button>
                </form>
                <p class="contact-email">あるいは、tetsu2626[あと]gmail.com 宛にメールをください。</p>
            </div>
        </section>
    </main>
    
    <div id="project-modal-overlay" class="project-modal-overlay">
        <div id="project-modal-content" class="project-modal"></div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        const ARTICLES_DATABASE_ID = '202fc6b604188067baedcd752b1bb428';
        const PROJECTS_DATABASE_ID = '213fc6b60418809abd4bfb8fe911629a';
        
        const PROP_NAMES = {
            article: {
                category: 'Content Category',  // 元に戻す
                title: 'Title',
                image: 'OGP Image',
                url: 'URL',
                publishedDate: '公開日',
                client: '取引先',
                role: 'Role'  // 元に戻す
            },
            project: {
                title: 'プロジェクト名',
                image: '添付画像',
                category: 'カテゴリ',
                description: 'プロジェクト概要',
                client: '取引先',
                period: '制作期間',
                summary: 'サマリ',
                url: 'URL',
                status: '公開状態',
                order: '表示順',
                relatedArticles: '関連記事',
                role: '担当役割'
            }
        };

        const pageElements = {
            navLinks: document.querySelectorAll('.nav-link'),
            pageSections: document.querySelectorAll('.page-section'),
            hamburgerBtn: document.getElementById('hamburger-btn'),
            sidebar: document.getElementById('sidebar'),
            articlesGrid: document.getElementById('articles-grid'),
            topArticlesGrid: document.getElementById('top-articles-grid'),
            projectsGrid: document.getElementById('projects-grid'),
            topProjectsGrid: document.getElementById('top-projects-grid'),
            articleTabs: document.getElementById('article-tabs'),
            projectModalOverlay: document.getElementById('project-modal-overlay'),
            projectModalContent: document.getElementById('project-modal-content'),
        };

        let allArticlesData = [];
        let allProjectsData = [];
        let ogpCache = new Map(); // OGPデータのキャッシュ

        async function callNotionApi(databaseId, filter, sorts) {
            try {
                const response = await fetch('/.netlify/functions/notion', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ databaseId, filter, sorts })
                });
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(errorText || 'API request failed');
                }
                const responseText = await response.text();
                if (!responseText) {
                    throw new Error('Server returned an empty response.');
                }
                return JSON.parse(responseText);
            } catch (error) {
                console.error('callNotionApi failed:', error);
                throw error;
            }
        }

        function renderArticleCard(container, article) {
            const props = article.properties;
            const title = props[PROP_NAMES.article.title]?.title[0]?.plain_text || 'No Title';
            const imageUrl = props[PROP_NAMES.article.image]?.files[0]?.file?.url || props[PROP_NAMES.article.image]?.files[0]?.external?.url || '';
            const pageUrl = props[PROP_NAMES.article.url]?.url || '#';
            const media = props[PROP_NAMES.article.media]?.rich_text[0]?.plain_text || '';
            
            const roles = props[PROP_NAMES.article.role]?.multi_select || [];
            const tagsHtml = roles.map(tag => `<span class="card-tag-pill">#${tag.name}</span>`).join('');

            const cardHtml = `
                <a href="${pageUrl}" target="_blank" rel="noopener noreferrer" class="card">
                    <div class="card-image" style="background-image: url('${imageUrl}')"></div>
                    <div class="card-content">
                        <p class="card-title">${title}</p>
                        <p class="card-media">${media}</p>
                        <div class="card-tags">${tagsHtml}</div>
                    </div>
                </a>
            `;
            container.insertAdjacentHTML('beforeend', cardHtml);
        }

        function renderArticles(category) {
            const container = pageElements.articlesGrid;
            container.innerHTML = '';
            
            let articlesToRender;

            // Articlesページでは常にカテゴリでフィルタリング
            articlesToRender = allArticlesData.filter(article => {
                const cat = article.properties[PROP_NAMES.article.category]?.select?.name;
                return cat === category;
            });

            if (articlesToRender.length === 0) {
                container.innerHTML = '<p>表示できる記事がありません。</p>';
                return;
            }

            articlesToRender.forEach(article => renderArticleCard(container, article));
        }

        async function fetchAllArticles() {
            const articlesContainer = pageElements.articlesGrid;
            const topArticlesContainer = pageElements.topArticlesGrid;
            articlesContainer.innerHTML = '<p>読み込み中...</p>';
            topArticlesContainer.innerHTML = '<p>読み込み中...</p>';

            // ソート機能を無効化（JavaScriptでPriorityソートするため）
            const sorts = [];

            try {
                const data = await callNotionApi(ARTICLES_DATABASE_ID, null, sorts);
                allArticlesData = data.results;
                
                // Priorityプロパティで昇順ソート（数字の小さい順）
                allArticlesData.sort((a, b) => {
                    const priorityA = a.properties[PROP_NAMES.article.priority]?.number || 999;
                    const priorityB = b.properties[PROP_NAMES.article.priority]?.number || 999;
                    return priorityA - priorityB; // 昇順（Priority順）
                });
                
                // デフォルトカテゴリを 'Design' に設定
                const defaultCategory = 'Design';
                renderArticles(defaultCategory);

                // 対応するタブをアクティブにする
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.category === defaultCategory) {
                        btn.classList.add('active');
                    }
                });

                topArticlesContainer.innerHTML = '';
                const featuredArticles = allArticlesData
                    .filter(article => article.properties[PROP_NAMES.article.featured]?.checkbox === true)
                    .slice(0, 3);
                
                if (featuredArticles.length > 0) {
                    featuredArticles.forEach(article => renderArticleCard(topArticlesContainer, article));
                } else {
                    topArticlesContainer.innerHTML = '<p>注目の記事はありません。</p>';
                }

            } catch (error) {
                console.error('Articlesの取得に失敗:', error);
                articlesContainer.innerHTML = '<p>記事データの取得に失敗しました。</p>';
                topArticlesContainer.innerHTML = '';
            }
        }
        
        async function fetchAndRenderProjects() {
            const projectsContainer = pageElements.projectsGrid;
            const topProjectsContainer = pageElements.topProjectsGrid;
            projectsContainer.innerHTML = '<p>読み込み中...</p>';
            topProjectsContainer.innerHTML = '<p>読み込み中...</p>';
            
            // 公開状態でフィルタリング（公開のみ表示）
            const filter = {
                property: PROP_NAMES.project.status,
                checkbox: {
                    equals: true
                }
            };
            
            // 表示順でソート
            const sorts = [
                { property: PROP_NAMES.project.order, direction: 'ascending' }
            ];
            
            try {
                const data = await callNotionApi(PROJECTS_DATABASE_ID, filter, sorts);
                allProjectsData = data.results;

                projectsContainer.innerHTML = '';
                topProjectsContainer.innerHTML = '';

                if (allProjectsData.length === 0) {
                     projectsContainer.innerHTML = topProjectsContainer.innerHTML = '<p>表示できるプロジェクトがありません。</p>';
                     return;
                }
                
                allProjectsData.forEach(project => renderProjectCard(projectsContainer, project));
                allProjectsData.slice(0, 4).forEach(project => renderProjectCard(topProjectsContainer, project));

            } catch (error) {
                console.error('Projectsの取得に失敗:', error);
                projectsContainer.innerHTML = topProjectsContainer.innerHTML = `<p>プロジェクトデータの取得に失敗しました。データベースID等を確認してください。</p>`;
            }
        }
        
        async function fetchOgpImageForCard(url, cardElement) {
            const imageDiv = cardElement.querySelector('.project-card-image');
            if (!imageDiv) return;

            try {
                const response = await fetch('/.netlify/functions/ogp-fetcher', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url })
                });

                if (!response.ok) throw new Error('Response not OK');
                const data = await response.json();

                if (data.image) {
                    imageDiv.style.backgroundImage = `url('${data.image}')`;
                    imageDiv.style.backgroundSize = 'cover';
                    imageDiv.style.backgroundPosition = 'center center';
                    imageDiv.style.backgroundRepeat = 'no-repeat';
                    imageDiv.style.color = 'transparent'; // 文字を透明にして画像を表示
                    imageDiv.textContent = ''; // テキストを削除
                } else {
                    // OGP画像がない場合はタイトルを表示
                    imageDiv.textContent = data.title || imageDiv.textContent;
                    imageDiv.classList.remove('loading');
                }
            } catch (error) {
                console.error('Error fetching OGP image for card:', error);
                imageDiv.classList.remove('loading');
            }
        }

        function renderProjectCard(container, project) {
             const props = project.properties;
             const title = props[PROP_NAMES.project.title]?.title[0]?.plain_text || 'No Title';
             const client = props[PROP_NAMES.project.client]?.rich_text.map(t => t.plain_text).join('') || '';
             const category = props[PROP_NAMES.project.category]?.select?.name || '';
             const relatedUrl = props[PROP_NAMES.project.url]?.url || '';
             
             const cardHtml = `
                <div class="card project-card" data-project-id="${project.id}">
                    <div class="project-card-image loading">${relatedUrl ? '読み込み中...' : (client || 'Client')}</div>
                    <div class="project-card-content">
                        <p class="project-card-title">${title}</p>
                        <p class="project-card-role">${category}</p>
                    </div>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', cardHtml);
            
            // OGP画像を非同期で取得
            if (relatedUrl) {
                const cardElement = container.lastElementChild;
                fetchOgpImageForCard(relatedUrl, cardElement);
            }
        }
        
        function formatText(text) {
            if (!text) return '';
            
            const lines = text.split('\n').filter(line => line.trim() !== '');
            let html = '';
            let inList = false;

            for (const line of lines) {
                if (line.startsWith('- ')) {
                    if (!inList) {
                        html += '<ul class="custom-list">';
                        inList = true;
                    }
                    html += `<li>${line.substring(2).trim()}</li>`;
                } else {
                    if (inList) {
                        html += '</ul>';
                        inList = false;
                    }
                    html += `<p>${line}</p>`;
                }
            }
            if (inList) {
                html += '</ul>';
            }
            return html;
        }

        function openProjectModal(projectId) {
            const project = allProjectsData.find(p => p.id === projectId);
            if (!project) return;
            
            const props = project.properties;
            const title = props[PROP_NAMES.project.title]?.title[0]?.plain_text || 'No Title';
            const description = props[PROP_NAMES.project.description]?.rich_text.map(t => t.plain_text).join('') || '';
            const summary = props[PROP_NAMES.project.summary]?.rich_text.map(t => t.plain_text).join('') || '';
            const client = props[PROP_NAMES.project.client]?.rich_text.map(t => t.plain_text).join('') || '';
            const period = props[PROP_NAMES.project.period]?.rich_text.map(t => t.plain_text).join('') || '';
            const role = props[PROP_NAMES.project.role]?.multi_select?.map(item => item.name).join(', ') || '';
            const relatedUrl = props[PROP_NAMES.project.url]?.url || '';
            const attachedImage = props[PROP_NAMES.project.image]?.files[0]?.file?.url || props[PROP_NAMES.project.image]?.files[0]?.external?.url || '';

            // デバッグ用ログ
            console.log('=== PROJECT MODAL DEBUG ===');
            console.log('Project ID:', projectId);
            console.log('Project role:', role);
            console.log('Category property:', props[PROP_NAMES.project.category]);
            console.log('PROP_NAMES.project.category:', PROP_NAMES.project.category);
            console.log('All project properties:', props);
            console.log('===========================');
            
            // 担当役割の詳細デバッグ
            console.log('=== ROLE DEBUG ===');
            console.log('PROP_NAMES.project.role:', PROP_NAMES.project.role);
            console.log('Role property raw:', props['担当役割']);
            console.log('Role property via PROP_NAMES:', props[PROP_NAMES.project.role]);
            console.log('Available properties:', Object.keys(props));
            console.log('==================');

            // URLにリンクを自動検出・変換する関数（先にURLリンク化してからformatText適用）
            function formatTextWithLinks(text) {
                if (!text) return '';
                // まずURLをリンクに変換
                const urlRegex = /(https?:\/\/[^\s<]+)/g;
                const linkedText = text.replace(urlRegex, '<a href="$1" target="_blank" rel="noopener noreferrer" style="color: #0066cc; text-decoration: underline;">$1</a>');
                // その後formatTextを適用
                return formatText(linkedText);
            }

            // シンプルなテキストのURL変換（formatTextを適用しない場合）
            function addLinksToText(text) {
                if (!text) return '';
                const urlRegex = /(https?:\/\/[^\s<]+)/g;
                return text.replace(urlRegex, '<a href="$1" target="_blank" rel="noopener noreferrer" style="color: #0066cc; text-decoration: underline;">$1</a>');
            }

            const modalHtml = `
                <div class="project-modal-header">
                    <h2>${title}</h2>
                    <span class="project-modal-close">&times;</span>
                </div>
                <div class="project-modal-body">
                    <div id="ogp-card-container"></div>
                    <div style="margin-bottom: 30px; background: yellow; padding: 10px;">
                        デバッグ: role="${role}" category="${props[PROP_NAMES.project.category]?.select?.name || 'なし'}"
                        ${role ? `<br><span class="card-tag-pill" style="display: inline-block; padding: 4px 10px; font-size: 11px; font-weight: 500; background-color: #f0f0f0; color: #555; border-radius: 999px;">#${role}</span>` : '<br>roleが空です'}
                    </div>
                    
                    ${summary ? `<div class="detail-item"><strong>サマリ</strong><div>${formatTextWithLinks(summary)}</div></div>` : ''}
                    ${attachedImage ? `<div class="detail-item"><img src="${attachedImage}" alt="プロジェクト画像" style="max-width: 100%; height: auto; border-radius: 8px; margin-top: 8px;"></div>` : ''}
                    ${description ? `<div class="detail-item"><strong>プロジェクト概要</strong><div>${formatTextWithLinks(description)}</div></div>` : ''}
                    ${client ? `<div class="detail-item"><strong>クライアント</strong><p>${addLinksToText(client)}</p></div>` : ''}
                    ${period ? `<div class="detail-item"><strong>制作期間</strong><p>${addLinksToText(period)}</p></div>` : ''}
                </div>
            `;

            pageElements.projectModalContent.innerHTML = modalHtml;
            pageElements.projectModalOverlay.classList.add('active');
            
            // モーダルを即座に表示してからOGPを非同期で取得
            setTimeout(() => {
                if (relatedUrl) {
                    fetchOgpData(relatedUrl);
                } else {
                    const ogpContainer = document.getElementById('ogp-card-container');
                    if (ogpContainer) ogpContainer.style.display = 'none';
                }
            }, 0);

            pageElements.projectModalContent.querySelector('.project-modal-close').addEventListener('click', closeProjectModal);
        }

        async function fetchOgpData(url) {
            const container = document.getElementById('ogp-card-container');
            if (!container) return;
            
            // キャッシュチェック
            if (ogpCache.has(url)) {
                const cachedData = ogpCache.get(url);
                renderOgpCard(container, url, cachedData);
                return;
            }
            
            container.innerHTML = '<p style="font-size: 14px; color: #888;">関連リンクを読み込んでいます...</p>';

            try {
                // タイムアウト付きfetch
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000); // 5秒でタイムアウト

                const response = await fetch('/.netlify/functions/ogp-fetcher', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url }),
                    signal: controller.signal
                });

                clearTimeout(timeoutId);

                if (!response.ok) throw new Error('Response not OK');
                const data = await response.json();

                if (!data.title) {
                    throw new Error('No OGP data found');
                }

                // キャッシュに保存
                ogpCache.set(url, data);
                renderOgpCard(container, url, data);

            } catch (error) {
                console.error('Error fetching OGP data:', error);
                if (error.name === 'AbortError') {
                    container.innerHTML = `<div class="detail-item"><strong>関連URL</strong><p><a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a> <span style="color: #888; font-size: 12px;">(読み込みタイムアウト)</span></p></div>`;
                } else {
                    container.innerHTML = `<div class="detail-item"><strong>関連URL</strong><p><a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a></p></div>`;
                }
            }
        }

        function renderOgpCard(container, url, data) {
            const imageHtml = data.image ? `
                <div class="ogp-card-image">
                    <img src="${data.image}" alt="OGP Image" onerror="this.parentElement.style.display='none'">
                </div>` : '';

            // descriptionの文字数制限（280文字）
            const truncatedDescription = data.description && data.description.length > 280 
                ? data.description.substring(0, 280) + '…' 
                : data.description;

            container.innerHTML = `
                <a href="${url}" target="_blank" rel="noopener noreferrer" class="ogp-card">
                    ${imageHtml}
                    <div class="ogp-card-info">
                        <div class="ogp-card-description">${truncatedDescription}</div>
                        <div class="ogp-card-url">
                            ${data.favicon ? `<img src="${data.favicon}" alt="" onerror="this.style.display='none'">` : ''}
                            <span>${data.siteName || new URL(url).hostname}</span>
                        </div>
                    </div>
                </a>
            `;
        }
        
        function closeProjectModal() {
            pageElements.projectModalOverlay.classList.remove('active');
        }

        function navigateTo(pageId) {
            pageElements.pageSections.forEach(section => section.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            pageElements.navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${pageId}`) {
                    link.classList.add('active');
                }
            });
            window.scrollTo(0, 0);
            pageElements.sidebar.classList.remove('is-open');
        }
        
        function initialLoad() {
            fetchAllArticles();
            fetchAndRenderProjects();
        }
        
        // --- ▼ イベントリスナーの設定（修正版）▼ ---

        // ページ内ナビゲーションのリンクがクリックされた時の処理
        pageElements.navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const pageId = link.getAttribute('href').substring(1);
                navigateTo(pageId);
            });
        });

        // Articleページのタブボタンがクリックされた時の処理
        pageElements.articleTabs.addEventListener('click', (e) => {
            if (e.target.classList.contains('tab-button')) {
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                const category = e.target.dataset.category;
                renderArticles(category);
            }
        });

        // Projectカードがクリックされた時の処理
        document.addEventListener('click', (e) => {
            const card = e.target.closest('.project-card');
            if (card) {
                openProjectModal(card.dataset.projectId);
            }
        });

        // Project詳細モーダルの外側をクリックした時に閉じる処理
        pageElements.projectModalOverlay.addEventListener('click', (e) => {
            if (e.target === pageElements.projectModalOverlay) {
                closeProjectModal();
            }
        });

        // ハンバーガーボタンがクリックされた時の処理
        pageElements.hamburgerBtn.addEventListener('click', () => {
            pageElements.sidebar.classList.toggle('is-open');
        });

        initialLoad();
    });
    </script>
</body>
</html>